<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack4.x 配置指南 | Elecrabbit的博客</title>
    <meta name="generator" content="VuePress 1.5.1">
    <link rel="icon" href="/vblog/favicon.ico">
    <link rel="manifest" href="/vblog/manifest.json">
    <meta name="description" content="记录和分享 生活与技术">
    <link rel="preload" href="/vblog/assets/css/0.styles.80ee9225.css" as="style"><link rel="preload" href="/vblog/assets/js/app.273634a7.js" as="script"><link rel="preload" href="/vblog/assets/js/2.8c9e40d8.js" as="script"><link rel="preload" href="/vblog/assets/js/19.cd5e1fe1.js" as="script"><link rel="prefetch" href="/vblog/assets/js/10.2925db17.js"><link rel="prefetch" href="/vblog/assets/js/11.5bdc68b4.js"><link rel="prefetch" href="/vblog/assets/js/12.bbe978db.js"><link rel="prefetch" href="/vblog/assets/js/13.bc906d6a.js"><link rel="prefetch" href="/vblog/assets/js/14.df69f3e7.js"><link rel="prefetch" href="/vblog/assets/js/15.59937eaa.js"><link rel="prefetch" href="/vblog/assets/js/16.082f3800.js"><link rel="prefetch" href="/vblog/assets/js/17.6b3e7398.js"><link rel="prefetch" href="/vblog/assets/js/18.ab8fafa2.js"><link rel="prefetch" href="/vblog/assets/js/20.7764580e.js"><link rel="prefetch" href="/vblog/assets/js/21.a9379638.js"><link rel="prefetch" href="/vblog/assets/js/22.b05732fe.js"><link rel="prefetch" href="/vblog/assets/js/23.bfbfe40d.js"><link rel="prefetch" href="/vblog/assets/js/3.2f1f7874.js"><link rel="prefetch" href="/vblog/assets/js/4.a0155084.js"><link rel="prefetch" href="/vblog/assets/js/5.13652849.js"><link rel="prefetch" href="/vblog/assets/js/6.3f94e184.js"><link rel="prefetch" href="/vblog/assets/js/7.895c3b30.js"><link rel="prefetch" href="/vblog/assets/js/8.c0d13b4a.js"><link rel="prefetch" href="/vblog/assets/js/9.95f8bbde.js">
    <link rel="stylesheet" href="/vblog/assets/css/0.styles.80ee9225.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vblog/" class="home-link router-link-active"><!----> <span class="site-name">Elecrabbit的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vblog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vblog/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/vblog/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/vblog/dotnet/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/vblog/hardware/" class="nav-link">
  单片机
</a></div><div class="nav-item"><a href="/vblog/others/" class="nav-link">
  其他
</a></div> <a href="https://github.com/elecrabbit/vblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    My GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vblog/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vblog/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/vblog/web/" class="nav-link router-link-active">
  前端
</a></div><div class="nav-item"><a href="/vblog/dotnet/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/vblog/hardware/" class="nav-link">
  单片机
</a></div><div class="nav-item"><a href="/vblog/others/" class="nav-link">
  其他
</a></div> <a href="https://github.com/elecrabbit/vblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    My GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vblog/web/" aria-current="page" class="sidebar-link">前端记录</a></li><li><a href="/vblog/web/web前端学习笔记.html" class="sidebar-link">web前端学习笔记</a></li><li><a href="/vblog/web/如何开通国际域名和个人网站.html" class="sidebar-link">如何开通国际域名和个人网站</a></li><li><a href="/vblog/web/数据结构笔记.html" class="sidebar-link">大话数据结构笔记</a></li><li><a href="/vblog/web/推荐的coding网站信息.html" class="sidebar-link">程序员应该访问的最佳网站中文版</a></li><li><a href="/vblog/web/ES6新特性.html" class="sidebar-link">ES6新特性</a></li><li><a href="/vblog/web/Flex布局.html" class="sidebar-link">Flex布局</a></li><li><a href="/vblog/web/JavaScript学习笔记.html" class="sidebar-link">JavaScript基础</a></li><li><a href="/vblog/web/JavaScript中的函数变量作用域.html" class="sidebar-link">JavaScript中的函数变量作用域</a></li><li><a href="/vblog/web/jQuery笔记.html" class="sidebar-link">jQuery笔记</a></li><li><a href="/vblog/web/js面试题.html" class="sidebar-link">JS 面试题</a></li><li><a href="/vblog/web/webpack4.html" aria-current="page" class="active sidebar-link">webpack4.x 配置指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vblog/web/webpack4.html#起步" class="sidebar-link">起步</a></li><li class="sidebar-sub-header"><a href="/vblog/web/webpack4.html#创建webpack配置文件" class="sidebar-link">创建webpack配置文件</a></li><li class="sidebar-sub-header"><a href="/vblog/web/webpack4.html#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header"><a href="/vblog/web/webpack4.html#使用sourcemap" class="sidebar-link">使用sourcemap</a></li><li class="sidebar-sub-header"><a href="/vblog/web/webpack4.html#代码分离" class="sidebar-link">代码分离</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack4-x-配置指南"><a href="#webpack4-x-配置指南" class="header-anchor">#</a> webpack4.x 配置指南</h1> <h2 id="起步"><a href="#起步" class="header-anchor">#</a> 起步</h2> <p>初始化配置文件<code>package.json</code>并安装webpack</p> <div class="language-js extra-class"><pre class="language-js"><code>mkdir webpack<span class="token operator">-</span>demo <span class="token operator">&amp;&amp;</span> cd webpack<span class="token operator">-</span>demo
npm init <span class="token operator">-</span>y    <span class="token comment">//-y 初始化选项默认为 yes      </span>
npm i webpack webpack<span class="token operator">-</span>cli <span class="token operator">-</span><span class="token constant">D</span> <span class="token comment">// -D 即 -save-dev    版本4.x以上需要安装webpack-cli</span>
</code></pre></div><p>创建以下目录结构、文件和内容：</p> <div class="language-js extra-class"><pre class="language-js"><code>webpack<span class="token operator">-</span>demo
  <span class="token operator">|</span><span class="token operator">-</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json
<span class="token operator">+</span> <span class="token operator">|</span><span class="token operator">-</span> <span class="token operator">/</span>src
<span class="token operator">+</span>   <span class="token operator">|</span><span class="token operator">-</span> index<span class="token punctuation">.</span>js
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Hello webpack4!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="创建webpack配置文件"><a href="#创建webpack配置文件" class="header-anchor">#</a> 创建webpack配置文件</h2> <p>编写开发环境和生产环境彼此独立的webpack配置文件
先添加三个文件</p> <div class="language-js extra-class"><pre class="language-js"><code> webpack<span class="token operator">-</span>demo
  <span class="token operator">|</span><span class="token operator">-</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json
<span class="token operator">+</span> <span class="token operator">|</span><span class="token operator">-</span> webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js
<span class="token operator">+</span> <span class="token operator">|</span><span class="token operator">-</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js
<span class="token operator">+</span> <span class="token operator">|</span><span class="token operator">-</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js
  <span class="token operator">|</span><span class="token operator">-</span> <span class="token operator">/</span>src
    <span class="token operator">|</span><span class="token operator">-</span> index<span class="token punctuation">.</span>js
  <span class="token operator">|</span><span class="token operator">-</span> <span class="token operator">/</span>node_modules
</code></pre></div><p>1.<code>webpack.common.js</code></p> <p>用到两个基本的插件</p> <div class="language-js extra-class"><pre class="language-js"><code>npm i clean<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p><code>clean-webpack-plugin</code>：打包时自动清除输出文件夹中未用到的文件;
<code>html-webpack-plugin</code>：打包时会自动生成<code>index.html</code>并替换已有的<code>index.html</code>，bundle.js也会自行添加到 html 中。</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">//webpack.common.js</span>
    <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    
    module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
      entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
      plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token operator">:</span> <span class="token string">'index'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      output<span class="token operator">:</span> <span class="token punctuation">{</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>           
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>    <span class="token comment">//定义输出文件夹dist路径</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>2.<code>webpack.dev.js</code></p> <p>先安装webpack-merge,用以合并通用配置文件与开发环境配置文件</p> <div class="language- extra-class"><pre class="language-text"><code>npm i webpack-merge -D
</code></pre></div><p>安装开发服务器<code>devServer</code>,作用是修改代码后实时重新加载（刷新浏览器）</p> <div class="language-js extra-class"><pre class="language-js"><code>npm i webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//webpack.dev.js</span>
  <span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> common <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.common.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>common<span class="token punctuation">,</span><span class="token punctuation">{</span>
     devServer<span class="token operator">:</span> <span class="token punctuation">{</span>                <span class="token comment">//启用开发服务器</span>
       contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>   <span class="token comment">//告诉服务器从哪提供内容，只有在想要提供静态文件时才需要</span>
       compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>          <span class="token comment">//一切服务都启用gzip 压缩</span>
       host<span class="token operator">:</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>         <span class="token comment">//指定使用一个host，可用ip地址访问，没有的话如果别人访问会被禁止。默认localhost。</span>
       port<span class="token operator">:</span> <span class="token string">'9999'</span><span class="token punctuation">,</span>            <span class="token comment">//指定端口号，如省略，默认为”8080“</span>
       hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>               <span class="token comment">//启用模块热替换特性</span>
       inline<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">//启用内联模式，一段处理实时重载的脚本被插入到bundle中，并且构建消息会出现在浏览器控制台</span>
       historyApiFallback<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//开发单页应用时有用，依赖于HTML5 history API，设为true时所有跳转将指向index.html</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">//webpack内置的热更新插件</span>
     <span class="token punctuation">]</span><span class="token punctuation">,</span>
     mode<span class="token operator">:</span> <span class="token string">'development'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>HotModuleReplacementPlugin</code> 模块热替换(Hot Module Replacement)插件，用以在运行时更新发生改变的模块，从而无需进行完全刷新.</p> <p>3.<code>webpack.prod.js</code></p> <p>同样用'webpack-merge'合并通用配置文件与生产环境配置文件</p> <div class="language- extra-class"><pre class="language-text"><code>//webpack.prod.js
  const merge = require('webpack-merge');
  const common = require('./webpack.common.js');
    
  module.exports = merge(common,{
    mode: &quot;production&quot;
  });
</code></pre></div><blockquote><p>关于<code>mode</code></p></blockquote> <p>此时你可能会注意到配置文件中有个mode项，webpack4中新加，作用如下:</p> <ul><li><p>--mode production 生产环境</p> <p><em>不需要像旧版本一样定义node环境变量</em> <code>new webpack.DefinePlugin({&quot;process.env.NODE_ENV&quot;:JSON.stringify(&quot;production&quot;) })</code></p> <div class="language- extra-class"><pre class="language-text"><code>ps：许多 library 将通过与 process.env.NODE_ENV 环境变量关联，以决定 library 中应该引用哪些内容。当使用 process.env.NODE_ENV === 'production' 时，一些 library 可能针对具体用户的环境进行代码优化，从而删除或添加一些重要代码。
</code></pre></div><p><em>自动开启一些插件</em>，如：
<code>uglifyjs-webpack-plugin</code> js代码压缩(所以无需再单独使用)
<code>NoEmitOnErrorsPlugin</code> 编译出错时跳过输出，以确保输出资源不包含错误
<code>ModuleConcatenationPlugin</code> webpack3 添加的作用域提升(Scope Hoisting)</p></li> <li><p>--mode development 开发环境</p> <p><em>自行定义node环境变量为development</em> <code>new webpack.DefinePlugin({&quot;process.env.NODE_ENV&quot;:JSON.stringify(&quot;development&quot;) })</code> <em>使用 eval 构建 module, 提升增量构建速度</em> <em>自动开启一些插件</em>，如
<code>NamedModulesPlugin</code> 使用模块热替换(HMR)时会显示模块的相对路径</p></li></ul> <h2 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h2> <p>在<code>package.json</code> &quot;scripts&quot; 中添加npm脚本，从而快捷运行开发服务器 | 打包生产环境代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//package.json</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-demo&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --open --config webpack.dev.js&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config webpack.prod.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;clean-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.19&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.15.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.8&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-dev-server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.1.4&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-merge&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.1.3&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>&quot;start&quot;: &quot;webpack-dev-server --open --config webpack.dev.js&quot;,</code></p> <div class="language-js extra-class"><pre class="language-js"><code>webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server    启动开发服务器   
<span class="token operator">--</span>open    打开浏览器
<span class="token operator">--</span>config webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js    设置运行此脚本时执行的配置文件为webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js
</code></pre></div><p><code>&quot;build&quot;: &quot;webpack --config webpack.prod.js&quot;</code></p> <div class="language-js extra-class"><pre class="language-js"><code>webpack 启动webpack
<span class="token operator">--</span>config webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js   设置运行此脚本时执行的配置文件为webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>执行 npm start
</code></pre></div><p>此时应该可以看到 Hello webpack4!</p> <div class="language- extra-class"><pre class="language-text"><code>执行 npm run build
</code></pre></div><p>项目文件夹中自动生成打包后的文件目录（输出文件夹dist）</p> <div class="language- extra-class"><pre class="language-text"><code> webpack-demo
  |- package.json
  |- webpack.common.js
  |- webpack.dev.js
  |- webpack.prod.js
  |- /src
    |- index.js
  |- /dist 
      | - index.html
      | - app.bundle.js
  |- /node_modules
</code></pre></div><h2 id="使用sourcemap"><a href="#使用sourcemap" class="header-anchor">#</a> 使用sourcemap</h2> <p>sourcemap 能实现打包后的运行代码与源代码的映射，帮助我们debug到原始开发代码。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">///webpack.dev.js</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>common<span class="token punctuation">,</span><span class="token punctuation">{</span>
    devtool<span class="token operator">:</span> <span class="token string">'cheap-module-eval-source-map'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>大多数时候开发环境用'cheap-module-eval-source-map'是最好的选择，想要完整的功能又不介意构建速度的话就直接用'source-map'。具体的配置项很多，可以是eval，source-map，cheap，module，inline的任意组合。
具体每个参数的作用请查阅官方api：<a href="https://webpack.js.org/configuration/devtool/#src/components/Sidebar/Sidebar.jsx" target="_blank" rel="noopener noreferrer">https://webpack.js.org/config...<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
也可参考这篇文章<a href="https://segmentfault.com/a/1190000008315937" target="_blank" rel="noopener noreferrer">https://segmentfault.com/a/11...<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这里不做详述。</p> <h2 id="代码分离"><a href="#代码分离" class="header-anchor">#</a> 代码分离</h2> <p>把代码分离到不同的 bundle 中，可以按需加载或并行加载这些文件。可用于获取更小的 bundle，以及控制资源加载优先级，如果使用合理，会极大影响加载时间。</p> <p>三种常用的代码分离方法：</p> <p>1.入口起点：使用 entry 配置手动地分离代码。</p> <p>先在src文件夹添加一个文件another-module.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//another-module.js</span>
  <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Another'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>修改index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
  <span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>用到了lodash，安装下依赖</p> <div class="language- extra-class"><pre class="language-text"><code>npm i lodash -S
</code></pre></div><p>修改webpack.common.js中entry和output配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//webpack.common.js</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
      index<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
      another<span class="token operator">:</span> <span class="token string">'./src/another-module.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>            <span class="token comment">//根据入口文件名来定义输出文件名</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vblog/web/js面试题.html" class="prev">
        JS 面试题
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/vblog/assets/js/app.273634a7.js" defer></script><script src="/vblog/assets/js/2.8c9e40d8.js" defer></script><script src="/vblog/assets/js/19.cd5e1fe1.js" defer></script>
  </body>
</html>
